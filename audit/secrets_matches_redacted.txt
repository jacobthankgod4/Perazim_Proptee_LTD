Redacted secrets audit — generated 2026-02-03

High severity (secret keys, DB credentials, SMTP passwords):

- File: public_html/checkout.php
   Match (redacted): $paystack = new Yabacon\Paystack('[REDACTED_PAYSTACK_KEY]');
   Note: Hardcoded Paystack secret key. Rotate immediately and move to env var `PAYSTACK_SECRET`.

- File: public_html/includes/view/verification.php
   Match (redacted): $paystack_key = getenv('PAYSTACK_SECRET') ?: '[REDACTED_PAYSTACK_KEY]';
   Note: Fallback contains secret; ensure only `getenv('PAYSTACK_SECRET')` is used in production.

- File: public_html/Administration/mysql.inc.php
   Match (redacted): DEFINE('DB_PASSWORD', getenv('DB_PASSWORD') ?: '[REDACTED_DB_PASSWORD]');
   Note: Plaintext fallback present — rotate DB password and remove fallback from repo.

- File: public_html/old/Administration/mysql.inc.php
   Match (redacted): DEFINE ('DB_PASSWORD', '[REDACTED_DB_PASSWORD]');
   Note: Plaintext DB password in legacy copy — remove and rotate.

- File: public_html/start/.env
   Match (redacted): DB_PASSWORD="[REDACTED_DB_PASSWORD]"
   Note: `.env` contains DB credentials and `APP_DEBUG=true` (risk). Rotate secrets and remove `.env` from repo; add to `.gitignore`.

- File: public_html/mailer.php
   Match (redacted): $mail->Password   = '[REDACTED_SMTP_PASSWORD]';
   Note: SMTP password hardcoded. Rotate credentials and use env vars (e.g., `MAIL_PASSWORD`).

Medium severity (config leaks, debug flags, empty or example keys):

- File: public_html/.env.example
   Match: PAYSTACK_SECRET=
   Note: Example file present — fine as template, ensure no real values are stored here.

- File: public_html/start/.env
   Match: APP_DEBUG=true
   Note: Debug enabled in production `.env` — set to false and avoid shipping production envs.

Low severity (vendor references / package names):

- Files: public_html/composer.json, public_html/composer.lock
   Match: yabacon/paystack-php (package references)
   Note: Vendor packages may include example keys in test files; verify vendor/test files do not contain real secrets.

Recommended immediate actions:
- Rotate all exposed credentials (DB, SMTP, Paystack) immediately.
- Replace hardcoded secrets with environment variables and remove fallbacks from committed files.
- Add `/.env` and other secret files to `.gitignore` and publish a sanitized `.env.example`.
- Scrub git history for any leaked secrets after rotation using `git-filter-repo` or BFG; see separate guidance file.

Next steps I can take for you (pick any):
- (A) Expand the grep to cover additional patterns and produce a fuller redacted matches file.
- (B) Produce `git-filter-repo` or BFG commands and a short script to scrub repo history after you rotate keys.
- (C) Replace remaining hardcoded secrets in code with `getenv()` usages and commit a sanitized `.env.example`.

End of report.
